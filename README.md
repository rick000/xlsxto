# xlsxto

将excel表转换为json或配置代码

## 支持的转出格式
- [x] lua
- [x] json
- [ ] python
- [ ] sql
- [ ] xml

## 使用方法
```bash
xlsxto --input $xls_dir --output $code_dir --target lua
```

## 配表格式
- 第一行：中文名，字段对应的说明，代码中不使用
- 第二行：英文字段名，其中以KEY开头的，代表索引键，对应lua table的key值
- 第三行：校验条件（详细说明参考内置函数）
- 第四行: 是否导出，默认导出， none:不导出
- 第五行：字段类型
- 第六行-结束：配置的内容
- 如果一个xlsx文件里有多个sheet，每个sheet也必须是一样的格式

### 支持的字段类型
| 类型名    | 备注 |
| --------- | --------- |
| int | 整型         |
| float   | 浮点型         |
| long | 长整型 |
| int[]   | 整型数组         |
| float[]    | 浮点数组         | 
| long[] | 长整型数组 |
| string    | 字符串         | 

### 内置函数
| 函数名    | 说明 | 参数个数 | 使用举例 | 支持的类型|
| --------- | --------- | --------- | --------- | --------- |
|gt| 配表值于必须大于指定的值|1|```gt(100)```表示配表值必须大于100|int或float|
|ge|配表值必须大于或等于指定的值|1|```ge(100)```表示配表值必须大于或等于100|int或float|
|lt|配表值必须小于指定的值|1|```ge(100)```表示配表值必须小于100|int或float|
|le|配表值必须小于或等于指定的值|1|```ge(100)```表示配表值必须小于或等于100|int或float|
|eq|配表值必须等于指定的值|1|```eq(100)```表示配值必须等于100|任意|
|range|配表值必须在指定区间|2|```range(1, 100)```表示配表值必须大于或等于1并且小于等于100|int或float|
|len|配表值长度必须在指定区间|2|```len(1,10)```表示数组或字符串的长度介于1到10之间（左闭右闭）|string或localize或array|
|expect|配表值必须在指定表里出现过|2|```expect('Item.xlsx', 'id')```表示配置值代表道具Id，并且在道具表里有出现|int|
|and|且运算符|只能出现在两个函数中间|```gt(1) and lt(100)```|int或float|
|or|或运算符|只能出现在两个函数中间|```gt(100) or lt(1)```|int或float|
|not|否定运算符|必须后接函数|```not gt(100)```不大于100|int或float|
|空白|不校验||||